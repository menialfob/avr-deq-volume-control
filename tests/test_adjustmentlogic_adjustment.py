import pytest
from src.adjustmentlogic import calculate_adjustment

# Table data
absolute_values = [45, 45.5, 46, 46.5, 47, 47.5, 48, 48.5, 49, 49.5, 50, 50.5, 51, 51.5, 52, 52.5, 53, 53.5, 54, 54.5, 55, 55.5, 56, 56.5, 57, 57.5, 58, 58.5, 59, 59.5, 60, 60.5, 61, 61.5, 62, 62.5, 63, 63.5, 64, 64.5, 65, 65.5, 66, 66.5, 67, 67.5, 68, 68.5, 69, 69.5, 70, 70.5, 71, 71.5, 72, 72.5, 73, 73.5, 74, 74.5, 75, 75.5, 76, 76.5, 77, 77.5, 78, 78.5, 79, 79.5, 80]
reference_values = [45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]

# Expected results as a nested list (absolute_value corresponds to rows, reference_value to columns)
expected_results = [
    [0,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,0,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,0,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,0,0,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,0,0,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,0,0,0,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,0,0,0,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,0,0,0,0,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5,7.5,8,8,8.5,8.5],
    [0,0,0,0,0,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5,4.5,5,5,5,5.5,5.5,6,6,6,6.5,6.5,7,7,7,7.5,7.5,8,8],
    [0,0,0,0,0,0,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5,7.5],
    [0,0,0,0,0,0,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5,6.5,7,7,7.5],
    [0,0,0,0,0,0,0,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5,4.5,5,5,5,5.5,5.5,6,6,6,6.5,6.5,7,7],
    [0,0,0,0,0,0,0,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5,4.5,5,5,5,5.5,5.5,6,6,6,6.5,6.5,7],
    [0,0,0,0,0,0,0,0,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5,6.5],
    [0,0,0,0,0,0,0,0,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5,5.5,6,6,6.5],
    [0,0,0,0,0,0,0,0,0,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5,4.5,5,5,5,5.5,5.5,6,6],
    [0,0,0,0,0,0,0,0,0,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5,4.5,5,5,5,5.5,5.5,6],
    [0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5,5.5],
    [0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5,5,5.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5,4.5,5,5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5,5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5,4.5,5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5,4.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5,4.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5,4.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4,4.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4,4.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4,4],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4,4],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4,4],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5,4],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5,4],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5,3.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5,3.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5,3.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3,3.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3,3.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3,3],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3,3],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3,3],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5,3],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5,3],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5,2.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5,2.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5,2.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2,2.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2,2.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2,2],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2,2],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2,2],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5,2],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5,2],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5,1.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5,1.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5,1.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1,1.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1,1.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
]

# Generate test cases
adjustment_test_cases = [
    (abs_val, ref_val, expected_results[row_idx][col_idx])
    for row_idx, abs_val in enumerate(absolute_values)
    for col_idx, ref_val in enumerate(reference_values)
]


@pytest.mark.parametrize("absolute_value, reference_value, expected", adjustment_test_cases)
def test_calculate_adjustment(absolute_value, reference_value, expected):
    result = calculate_adjustment(absolute_value, reference_value)
    assert result == pytest.approx(expected, rel=1e-2), f"Failed for inputs: {absolute_value}, {reference_value}"
